
CREATE TABLE Departments (
  Code INTEGER PRIMARY KEY,
  Name varchar(255) NOT NULL ,
  Budget decimal NOT NULL 
);
CREATE TABLE Employees (
  SSN INTEGER PRIMARY KEY,
  Name varchar(255) NOT NULL ,
  LastName varchar(255) NOT NULL ,
  Department INTEGER NOT NULL , 
  foreign key (department) references Departments(Code) 
);
INSERT INTO Departments(Code,Name,Budget) VALUES(14,'IT',65000);
INSERT INTO Departments(Code,Name,Budget) VALUES(37,'Accounting',15000);
INSERT INTO Departments(Code,Name,Budget) VALUES(59,'Human Resources',240000);
INSERT INTO Departments(Code,Name,Budget) VALUES(77,'Research',55000);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('123234877','Michael','Rogers',14);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('152934485','Anand','Manikutty',14);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('222364883','Carol','Smith',37);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('326587417','Joe','Stevens',37);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('332154719','Mary-Anne','Foster',14);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('332569843','George','ODonnell',77);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('546523478','John','Doe',59);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('631231482','David','Smith',77);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('654873219','Zacary','Efron',59);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('745685214','Eric','Goldsmith',59);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('845657245','Elizabeth','Doe',14);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('845657246','Kumar','Swamy',14);

select * from departments;
select * from employees;



1.Select the last name of all employees.
select employees.LastName from employees;
select e.LastName from employees e;

2. Select the last name of all employees, without duplicates.
select distinct employees.LastName from employees;

3. Select all the data of employees whose last name is "Smith".
select * from employees where LastName='Smith';

4. Select all the data of employees whose last name is "Smith" or "Doe".
select * from employees where LastName='Smith' or LastName='Doe';

5. Select all the data of employees that work in department 14.
select * from employees where department=14;

6. Select all the data of employees that work in department 37 or department 77.
select * from employees where department=37 or department=77;

7. Select the sum of all the departments budgets.
select SUM(budget)from departments;
> 375000

8. Select the number of employees in each department (you only need to show the department code and the number of employees).
select COUNT(department)from employees;
> 12
select department from employees
select count(*) from employees.department where department is not null;
> 12
***********************
select COUNT(department)from employees;

select count(*) from employees where department is not null;

select count(employees.department) from employees where department is not null;

select count(*) department from employees group by department;


select Department, count(*) from employees group by department;
select Department, count(*) as EmployeesIn from employees group by department;



9. Add a new department called "Quality Assurance", with a budget of $40,000 and departmental code 11.
INSERT INTO Departments(Code,Name,Budget) VALUES(11,'Quality Assurance',40000);
select * from departments;
 
10.Add an employee called "Mary Moore" in that department, with SSN 847-21-9811.
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('847219811','Mary','Moore',11);
select * from employees;

11. Reduce the budget of all departments by 10%.

12.Apply a 10% discount to all products.
update products set price=price*0.9;

13.Apply a 10% discount to all products with a price larger than or equal to 120.
update products set price=price*0.9 where price>=120;

14. Reassign all employees from the Research department (code 77) to the IT department (code 14).

15. Delete all employees in the IT department from the table (code 14).

16. Delete all employees from the table 
 
17.  joins questions(Employees.Department = Departments.Code)
 
Select all the data of employees, including each employee's department's data.
select a.*, b.* from employees a join departments b on a.department = b.code;

Select the name and last name of each employee, along with the name and budget of the employee's department.
select a.*, b.* from employees a join departments b on a.department = b.code;


--------------------------
extra code bits
select d.code,d.name,d.budget from departments d;
select e.SSN,e.Name,e.LastName,e.Department from employees e;
select d.code,d.name,d.budget,e.SSN,e.Name,e.LastName,e.Department from departments d full outer join employees e;
select d.code,d.name,d.budget,e.SSN,e.Name,e.LastName,e.Department from departments d full outer join employees e
on d.code = e.department;
